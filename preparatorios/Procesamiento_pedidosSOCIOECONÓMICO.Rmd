---
title: "Pedidos grales"
output: html_document
date: "`r Sys.Date()`"
---


## PEDIDO PROCESAMIENTO SOCIOECONOMICAS


```{r setup, message=FALSE, warning=FALSE}

#INSTALO LIBRERIAS QUE VOY A USAR

library(userfriendlyscience)
library(readxl)
library(dplyr)
library(tidyverse)
library(knitr)
library(eph)
library(openxlsx)
library(xlsx)


```


Leo base de datos con nuevas variables:


```{r carga_datos, echo=TRUE, message=FALSE, warning=FALSE}

# Lectura de archivo CSV

enma <-  read_csv("datos/ENMA_v2.csv",col_names = TRUE,col_types = NULL)


```

```{r exploración, include=FALSE, echo=FALSE}
names(enma)
str(enma)

```

##PEDIDOS ESPECIALES 


###Pedido59: ESTRATEGIAS PARA CUBRIR GASTOS
```{r q59, warning=FALSE, message=FALSE}


#análisis exploratorio de respuesta múltiple

pedido59_explor<-multiResponse(enma, items = c("Ahorro", "Prestamo_entorno", "Ayuda_estatal", "Ayuda_organizaciones",
                                   "Cuotas", "Fiado", "Prestamo_banco", "Venta_pertenencias", "Ninguna",
                                   "Prefiero_no_reponder"),
                   endorsedOption = 1)

pedido59_explor

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_explor), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="exploratorio",append = TRUE)

### me parece que Poblacion aca abajo, por ahi no exlcuye los missing no?

#Resultados
pedido59 <- enma %>%
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="univariado_agrup",append = TRUE)



#Resultados género
pedido59_genero <- enma %>% 
  group_by(genero_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_genero), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="genero",append = TRUE)


#Resultados edad
pedido59_edad <- enma %>% 
  group_by(edad_ag_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_edad), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="edad",append = TRUE)

#Resultados edad cada 10
pedido59_edad10 <- enma %>% 
  group_by(edad_10_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_edad10), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="edad_10",append = TRUE)

#Resultados edad agrupamiento enma 2020
pedido59_edadv2 <- enma %>% 
  group_by(edad_ag2_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_edadv2), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="edadv2",append = TRUE)


#Resultados tiempo de residencia
pedido59_tiempores <- enma %>% 
  group_by(tiempo_residencia_3_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_tiempores), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="tiempo_res",append = TRUE)


#Resultados tiempo de residencia v2
pedido59_tiempores2 <- enma %>% 
  group_by(tiempo_residencia_5_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_tiempores2), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="tiempo_res2",append = TRUE)

#Resultados migración reciente
pedido59_migrec <- enma %>% 
  group_by(migracion_reciente_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_migrec), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="migracion_rec",append = TRUE)

#Resultados nivel educativo
pedido59_niveled <- enma %>% 
  group_by(nivel_educativo_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_niveled), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="nivel_ed",append = TRUE)

#Resultados secundaria completa
pedido59_seccomp <- enma %>% 
  group_by(secundario_completo_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_seccomp), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="sec_comp", append = TRUE)


#Resultados region

pedido59_region <- enma %>% 
  group_by(region_CABA_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_region), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="region",append = TRUE)


#Resultados nacionalidad MERCOSUR
pedido59_MERCOSUR <- enma %>% 
  group_by(nac_agrupada) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_MERCOSUR), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="MERCOSUR",append = TRUE)


#Resultados nacionalidad
pedido59_nacionalidad <- enma %>% 
  group_by(nacionalidad_var) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_nacionalidad), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="nacionalidad",append = TRUE)

#Resultados tenencia DNI
pedido59_dni <- enma %>% 
  group_by(q17_dni_tenencia) %>% 
  summarise(Poblacion= sum(weightvec),
            Descapitalizacion  = sum(weightvec[Descapitalizacion==1]),
            Endeudamiento_informal = sum(weightvec[Endeudamiento_informal == 1]),
            Endeudamiento_formal = sum(weightvec[Endeudamiento_formal == 1]),
            Ayudas         = sum(weightvec[Ayudas == 1]),
            No_responde = sum(weightvec[Prefiero_no_responder == 1]),
            Ninguna = sum(weightvec[Ninguna_anteriores == 1]),
      'Prevalencia Descapitalización'  = round(Descapitalizacion/Poblacion*100,1),
      'Prevalencia Edeudamiento informal'          = round(Endeudamiento_informal/Poblacion*100,1),
'Prevalencia Edeudamiento formal'          = round(Endeudamiento_formal/Poblacion*100,1),
      'Prevalencia Ayudas'            = round(Ayudas/Poblacion*100,1),
'Prevalencia Prefiere no responder'          = round(No_responde/Poblacion*100,1),
      'Prevalencia Ninguna de las anteriores'            = round(Ninguna/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido59_dni), "tables/5.Socioeconómica/cuadros_pedido59.xlsx", row.names = FALSE, sheetName ="dni",append = TRUE)


```
```{r}
#análisis exploratorio de respuesta múltiple

pedido60_explor<-multiResponse(enma, items = c(
  "q60_subsidios_no", 
  "q60_subsidios_auh", 
  "q60_subsidios_embarazo", 
  "q60_subsidios_jubilacion", 
  "q60_subsidios_pension", 
  "q60_subsidios_pension_no_contrib", 
  "q60_subsidios_progresar", 
  "q60_subsidios_potenciar_trabajo", 
  "q60_subsidios_inclusion_joven", 
  "q60_subsidios_tarjeta_alimentar", 
  "q60_subsidios_pieza", 
  "q60_subsidios_desempleo", 
  "q60_subsidios_otro", 
  "q60_subsidios_prefiero_no"),
                   endorsedOption = 1)


pedido60_explor



```

```{r}
temp_qry<-enma %>%
  group_by(q60_subsidios_no) %>%
  summarise(tota=sum(weightvec))

temp_qry
```




```{r}

#análisis exploratorio de respuesta múltiple

pedido60_explor<-multiResponse(enma, items = c(
  "q60_subsidios_no", 
  "q60_subsidios_auh", 
  "q60_subsidios_embarazo", 
  "q60_subsidios_jubilacion", 
  "q60_subsidios_pension", 
  "q60_subsidios_pension_no_contrib", 
  "q60_subsidios_progresar", 
  "q60_subsidios_potenciar_trabajo", 
  "q60_subsidios_inclusion_joven", 
  "q60_subsidios_tarjeta_alimentar", 
  "q60_subsidios_pieza", 
  "q60_subsidios_desempleo", 
  "q60_subsidios_otro", 
  "q60_subsidios_prefiero_no"),
                   endorsedOption = 1)

pedido60_explor
#guardo tabulado
write.xlsx2(as.data.frame(pedido60_explor), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="exploratorio",append = TRUE)



#Resultados univariado
pedido60 <- enma %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="univariado",append = TRUE)

#Resultados genero
pedido60_genero <- enma %>% 
  group_by(genero_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_genero), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="genero",append = TRUE)

#Resultados edad
pedido60_edad <- enma %>% 
  group_by(edad_ag_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_edad), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="edad",append = TRUE)

#Resultados edad 10 años
pedido60_edad10 <- enma %>% 
  group_by(edad_10_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_edad10), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="edad_10",append = TRUE)

#Resultados edad2
pedido60_edad2 <- enma %>% 
  group_by(edad_ag2_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_edad2), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="edad2",append = TRUE)

#Resultados tiempo residencia
pedido60_tiempores <- enma %>% 
  group_by(tiempo_residencia_3_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_tiempores), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="tiempo_res",append = TRUE)



#Resultados tiempo residencia2
pedido60_tiempores2 <- enma %>% 
  group_by(tiempo_residencia_5_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_tiempores2), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="tiempo_res2",append = TRUE)


#Resultados migración reciente
pedido60_migrec <- enma %>% 
  group_by(migracion_reciente_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_migrec), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="migracion_rec",append = TRUE)



#Resultados nivel educativo
pedido60_niveled <- enma %>% 
  group_by(nivel_educativo_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_niveled), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="nivel_educativo",append = TRUE)




#Resultados tiempo residencia
pedido60_seccomp <- enma %>% 
  group_by(secundario_completo_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_seccomp), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="secundario_comp",append = TRUE)




#Resultados región
pedido60_region <- enma %>% 
  group_by(region_CABA_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_region), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="region",append = TRUE)



#Resultados MERCOSUR
pedido60_MERCOSUR<- enma %>% 
  group_by(nac_agrupada) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_MERCOSUR), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="MERCOSUR",append = TRUE)



#Resultados NACIONALIDAD
pedido60_nacionalidad<- enma %>% 
  group_by(nacionalidad_var) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_nacionalidad), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="nacionalidad",append = TRUE)



#Resultados dni
pedido60_dni <- enma %>% 
  group_by(q17_dni_tenencia) %>% 
  summarise(Poblacion= sum(weightvec),
            No_recibe  = sum(weightvec[q60_no_recibe==1]),
            Prestacion_contributiva = sum(weightvec[q60_contributivas == 1]),
            Prestacion_no_contributiva = sum(weightvec[q60_no_contributivas == 1]),
      'No recibe subsidios/prestaciones'  = round(No_recibe/Poblacion*100,1),
      'Recibe prestaciones contributivas'          = round(Prestacion_contributiva/Poblacion*100,1),
'Recibe prestaciones no contributivas'          = round(Prestacion_no_contributiva/Poblacion*100,1))

#guardo tabulado
write.xlsx2(as.data.frame(pedido60_dni), "tables/5.Socioeconómica/cuadros_pedido60.xlsx", row.names = FALSE, sheetName ="dni",append = TRUE)



```

##Pedido 15

Cruce preguntas capítulo socio-económica con posesión de DNI
q17 x q51, 52,53, 55, 56 y 57


```{r}
#resultados q17xq51
pedido15_q51<-calculate_tabulates(base=enma,
                                  x="q51_situacion_ocupacional",
                                  y="q17_dni_tenencia",
                                  add.percentage = 'col',
                                  add.totals = 'row',
                                  weights = 'weightvec')

pedido15_q51tot<-calculate_tabulates(base=enma,
                                  x="q51_situacion_ocupacional",
                                  y="q17_dni_tenencia",
                                  add.totals = 'row',
                                  weights = 'weightvec')


#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q51), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q51",append = TRUE)
#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q51tot), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q51_tot",append = TRUE)


#resultados q17xq52

pedido15_q52<-calculate_tabulates(base=enma,
                                  x="q52_trabaja",
                                  y="q17_dni_tenencia",
                                  add.percentage = 'col',
                                  add.totals = 'row',
                                  weights = 'weightvec')

pedido15_q52tot<-calculate_tabulates(base=enma,
                                  x="q52_trabaja",
                                  y="q17_dni_tenencia",
                                  add.totals = 'row',
                                  weights = 'weightvec')

#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q52), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q52",append = TRUE)
#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q52tot), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q52_tot",append = TRUE)


#resultados q17xq53
names(enma)
pedido15_q53<-calculate_tabulates(base=enma,
                                  x="q53_trabajo_formal",
                                  y="q17_dni_tenencia",
                                  add.percentage = 'col',
                                  add.totals = 'row',
                                  weights = 'weightvec')

pedido15_q53tot<-calculate_tabulates(base=enma,
                                  x="q53_trabajo_formal",
                                  y="q17_dni_tenencia",
                                  add.totals = 'row',
                                  weights = 'weightvec')

#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q53), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q53",append = TRUE)
#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q53tot), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q53_tot",append = TRUE)


#resultados q17xq55

pedido15_q55<-calculate_tabulates(base=enma,
                                  x="q55_experiencia",
                                  y="q17_dni_tenencia",
                                  add.percentage = 'col',
                                  add.totals = 'row',
                                  weights = 'weightvec')

pedido15_q55tot<-calculate_tabulates(base=enma,
                                  x="q55_experiencia",
                                  y="q17_dni_tenencia",
                                  add.totals = 'row',
                                  weights = 'weightvec')

#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q55), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q55",append = TRUE)
#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q55tot), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q55_tot",append = TRUE)


#resultados q17xq56

pedido15_q56<-calculate_tabulates(base=enma,
                                  x="q56_ocupacion_dificultad",
                                  y="q17_dni_tenencia",
                                  add.percentage = 'col',
                                  add.totals = 'row',
                                  weights = 'weightvec')

pedido15_q56tot<-calculate_tabulates(base=enma,
                                  x="q56_ocupacion_dificultad",
                                  y="q17_dni_tenencia",
                                  add.totals = 'row',
                                  weights = 'weightvec')

#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q56), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q56",append = TRUE)
#guardo tabulado
write.xlsx2(as.data.frame(pedido15_q56tot), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q56_tot",append = TRUE)



```

##q17 cruaza por q57
```{r}

#convierto q57 en numérica

enma<-enma %>% 
  mutate(q57_dificultad_trabajo=case_when(q57_dificultad_trabajo==1 ~1,
                                          TRUE~ 0)) %>% 
  mutate(q57_dificultad_titulos=case_when(q57_dificultad_titulos==1 ~1,
                                          TRUE ~0)) %>% 
  mutate(q57_dificultad_discriminacion=case_when(q57_dificultad_discriminacion==1 ~1,
                                                 TRUE ~0)) %>% 
  mutate(q57_dificultad_hogar=case_when(q57_dificultad_hogar==1 ~1,
                                        TRUE~0)) %>% 
  mutate(q57_dificultad_sexual=case_when(q57_dificultad_sexual==1 ~1,
                                         TRUE ~0)) %>% 
  mutate(q57_dificultad_documentacion=case_when(q57_dificultad_documentacion==1 ~1,
                                                TRUE~0)) %>% 
  mutate(q57_dificultad_idioma=case_when(q57_dificultad_idioma==1~1,
                                         TRUE~0)) %>% 
  mutate(q57_dificultad_edad=case_when(q57_dificultad_edad==1~1,
                                       TRUE~0)) %>% 
  mutate(q57_dificultad_inexperiencia=case_when(q57_dificultad_inexperiencia==1~1,
                                                TRUE~0)) %>% 
  mutate(q57_dificultad_falta_oferta=case_when(q57_dificultad_falta_oferta==1~1,
                                               TRUE~0)) %>% 
  mutate(q57_dificultad_salud=case_when(q57_dificultad_salud==1~1,
                                        TRUE~0)) %>% 
  mutate(q57_dificultad_desconocimiento=case_when(q57_dificultad_desconocimiento==1~1,
                                                  TRUE~0)) %>% 
  mutate(q57_dificultad_prefiero_no=case_when(q57_dificultad_prefiero_no==1~1,
                                              TRUE~0))

unique(enma$q56_ocupacion_dificultad)
pedido15_q57<-enma %>% 
  filter(q56_ocupacion_dificultad=="Si") %>% 
  group_by(q17_dni_tenencia) %>% 
  summarise(Poblacion= sum(weightvec),
            titulos  = sum(weightvec[q57_dificultad_titulos==1]),
            discriminacion = sum(weightvec[q57_dificultad_discriminacion == 1]),
            hogar = sum(weightvec[q57_dificultad_hogar == 1]),
            sexual = sum(weightvec[q57_dificultad_sexual == 1]),
            documentacion = sum(weightvec[q57_dificultad_documentacion == 1]),
            idioma = sum(weightvec[q57_dificultad_idioma == 1]),
            edad = sum(weightvec[q57_dificultad_edad == 1]),
            inexperiencia = sum(weightvec[q57_dificultad_inexperiencia == 1]),
            falta_oferta = sum(weightvec[q57_dificultad_falta_oferta == 1]),
            salud = sum(weightvec[q57_dificultad_salud == 1]),
            desconocimiento = sum(weightvec[q57_dificultad_desconocimiento == 1]),
            prefiero_no = sum(weightvec[q57_dificultad_prefiero_no == 1]),
      'Títilos'  = round(titulos/Poblacion*100,1),
      'Discriminación'          = round(discriminacion/Poblacion*100,1),
'Hogar'          = round(hogar/Poblacion*100,1),
'Sexual'          = round(sexual/Poblacion*100,1),
'Documentación'          = round(documentacion/Poblacion*100,1),
'Idioma'          = round(idioma/Poblacion*100,1),
'Edad'          = round(edad/Poblacion*100,1),
'Inexperiencia'          = round(inexperiencia/Poblacion*100,1),
'Falta de oferta'          = round(falta_oferta/Poblacion*100,1),
'Salud'          = round(salud/Poblacion*100,1),
'Desconocimiento'          = round(desconocimiento/Poblacion*100,1),
'Prefiero no responder'          = round(prefiero_no/Poblacion*100,1))

write.xlsx2(as.data.frame(pedido15_q57), "tables/5.Socioeconómica/cuadros_pedido15.xlsx", row.names = FALSE, sheetName ="q57",append = TRUE)

```

##Pedido 32: Cruce entre dificultades para el acceso al trabajo y trabajo formal. q53 por q56

```{r}

pedido32<-calculate_tabulates(base=enma,
                              x="q56_ocupacion_dificultad",
                              y="q53_trabajo_formal",
                              add.percentage = 'col',
                              add.totals = 'row',
                              weights = 'weightvec')


pedido32tot<-calculate_tabulates(base=enma,
                                  x="q56_ocupacion_dificultad",
                                  y="q53_trabajo_formal",
                                  add.totals = 'row',
                                  weights = 'weightvec')

#guardo tabulado
write.xlsx2(as.data.frame(pedido32), "tables/5.Socioeconómica/cuadros_varios.xlsx", row.names = FALSE, sheetName ="pedido32",append = TRUE)
#guardo tabulado
write.xlsx2(as.data.frame(pedido32tot), "tables/5.Socioeconómica/cuadros_varios.xlsx", row.names = FALSE, sheetName ="pedido32tot",append = TRUE)
```

##Pedido 33. Conocer la relación entre envío o no de remesas con Motivos de migración
q588 x q14
```{r}
names(enma)
unique(enma$q58_envio_dinero)

enma<-enma %>% 
  mutate(q14_motivos_estudio=case_when(q14_motivos_estudio==1~1,
                                       TRUE~0)) %>% 
  mutate(q14_motivos_mejor_trabajo=case_when(q14_motivos_mejor_trabajo==1~1,
                                             TRUE~0)) %>% 
  mutate(q14_motivos_nuevas_experiencias=case_when(q14_motivos_nuevas_experiencias==1~1,
                                                   TRUE~0)) %>% 
  mutate(q14_motivos_violencia_genero=case_when(q14_motivos_violencia_genero==1~1,
                                                TRUE~0)) %>% 
  mutate(q14_motivos_orientacion_sexual=case_when(q14_motivos_orientacion_sexual==1~1,
                                                  TRUE~0)) %>% 
  mutate(q14_motivos_persecucion=case_when(q14_motivos_persecucion==1~1,
                                           TRUE~0)) %>% 
  mutate(q14_motivos_salud=case_when(q14_motivos_salud==1~1,
                                     TRUE~0)) %>% 
  mutate(q14_motivos_habitat=case_when(q14_motivos_habitat==1~1,
                                       TRUE~0)) %>% 
  mutate(q14_motivos_necesidades_basicas=case_when(q14_motivos_necesidades_basicas==1~1,
                                                   TRUE~0)) %>% 
  mutate(q14_motivos_reunificacion=case_when(q14_motivos_reunificacion==1~1,
                                             TRUE~0)) %>% 
  mutate(q14_motivos_acompañar_otrx=case_when(q14_motivos_acompañar_otrx==1~1,
                                              TRUE~0)) %>% 
  mutate(q14_motivos_otros=case_when(q14_motivos_otros==1~1,
                                     TRUE~0))

pedido33<-enma %>% 
  group_by(q58_envio_dinero) %>% 
    summarise(Poblacion= sum(weightvec),
            estudio  = sum(weightvec[q14_motivos_estudio==1]),
            trabajo = sum(weightvec[q14_motivos_mejor_trabajo == 1]),
            nuevas_exp = sum(weightvec[q14_motivos_nuevas_experiencias == 1]),
            VBG = sum(weightvec[q14_motivos_violencia_genero == 1]),
            orientacion_sexual = sum(weightvec[q14_motivos_orientacion_sexual == 1]),
            persecucion = sum(weightvec[q14_motivos_persecucion == 1]),
            salud = sum(weightvec[q14_motivos_salud == 1]),
            habitat = sum(weightvec[q14_motivos_habitat == 1]),
            nec_bas = sum(weightvec[q14_motivos_necesidades_basicas == 1]),
            reunif = sum(weightvec[q14_motivos_reunificacion == 1]),
            acomp_otrx = sum(weightvec[q14_motivos_acompañar_otrx == 1]),
            otros = sum(weightvec[q14_motivos_otros == 1]),
      'Estudio'  = round(estudio/Poblacion*100,1),
      'Mejor trabajo' = round(trabajo/Poblacion*100,1),
'Nuevas experiencias'  = round(nuevas_exp/Poblacion*100,1),
'Violencia de género'  = round(VBG/Poblacion*100,1),
'Orientación sexual' = round(orientacion_sexual/Poblacion*100,1),
'Persecución'          = round(persecucion/Poblacion*100,1),
'Salud'          = round(salud/Poblacion*100,1),
'Habitat'          = round(habitat/Poblacion*100,1),
'Necesidades básicas' = round(nec_bas/Poblacion*100,1),
'Reunificación familiar'  = round(reunif/Poblacion*100,1),
'Acompañar a otrx'= round(acomp_otrx/Poblacion*100,1),
'Otros'       = round(otros/Poblacion*100,1))


write.xlsx2(as.data.frame(pedido33), "tables/5.Socioeconómica/cuadros_varios.xlsx", row.names = FALSE, sheetName ="pedido33",append = TRUE)

```


```{r}

pedido53<-calculate_tabulates(base=enma,
                              x="q52_trabaja",
                              y="nivel_educativo_var",
                              add.percentage = 'row',
                              add.totals = 'col',
                              weights = 'weightvec')

```


